#!/bin/bash

source ~/.dotfiles.env

CLIPBOARD_FILE="${DOTFILES_CONFIG_CLIPBOARD_FILE:-/tmp/clipboard}"
copy  () { cat > "$CLIPBOARD_FILE"; }
paste () { cat   "$CLIPBOARD_FILE"; }

FILE_ONLY_MODE="${DOTFILES_CONFIG_CLIPBOARD_FILE_ONLY_MODE:-false}"

if [[ "$FILE_ONLY_MODE" != 'true' ]]; then
    if which xsel > /dev/null 2>&1; then
        copy  () { xsel -ib; }
        paste () { xsel -ob; }
    fi
fi

[[ ! -t 0 ]] && pipe_input='true'
[[ ! -t 1 ]] && pipe_output='true'

[[ -n "$pipe_input" ]] && copy
paste | cat
